# Program.cs é‡æ§‹è¨ˆç•«

ç¶“éåˆ†æï¼Œæˆ‘ç™¼ç¾ä»¥ä¸‹é‡è¤‡çš„ç¨‹å¼ç¢¼æ¨¡å¼ï¼Œä»¥ä¸‹æ˜¯æ¶ˆé™¤é‡è¤‡çš„é‡æ§‹è¨ˆç•«:

## ğŸ” é‡è¤‡æ¨¡å¼è­˜åˆ¥

### 1. é è¦½åŠŸèƒ½é‡è¤‡ (å‡ºç¾ 3 æ¬¡)
- `ViewMarkedForDeletionFiles()` ç¬¬ 997-1040 è¡Œ
- `ViewSkippedFiles()` ç¬¬ 814-874 è¡Œ
- `InteractiveDeleteDuplicates()` ç¬¬ 358-393 è¡Œ

é€™ä¸‰è™•éƒ½æœ‰é¡ä¼¼çš„é è¦½é‚è¼¯ï¼Œè™•ç† `p` æŒ‡ä»¤ä¸¦è§£æç·¨è™Ÿã€‚

### 2. å ±è¡¨ç”Ÿæˆé‡è¤‡ (å‡ºç¾ 2 æ¬¡)
- `GenerateJsonReport()` ç¬¬ 1420-1461 è¡Œ
- `GenerateMarkedForDeletionJsonReport()` ç¬¬ 1463-1504 è¡Œ
- `GenerateHtmlReport()` ç¬¬ 1506-1559 è¡Œ
- `GenerateMarkedForDeletionHtmlReport()` ç¬¬ 1561-1614 è¡Œ

é€™äº›æ–¹æ³•çµæ§‹å¹¾ä¹ç›¸åŒï¼Œåªæ˜¯è³‡æ–™ä¾†æºä¸åŒã€‚

### 3. ç¢ºèªå°è©±æ¡†é‡è¤‡ (å‡ºç¾å¤šæ¬¡)
- ç¬¬ 426-430 è¡Œã€501-504 è¡Œã€663-666 è¡Œã€878-881 è¡Œã€1044-1047 è¡Œã€1091-1094 è¡Œ

å¤šè™•ä½¿ç”¨ç›¸åŒçš„ `(Y/n)` ç¢ºèªé‚è¼¯ã€‚

### 4. è³‡æ–™åº«æ“ä½œé‡è¤‡
- `LoadMarkedForDeletionFilesWithDetails()` å’Œ `LoadMarkedForDeletionFilesGroupedByHash()`
- `GenerateJsonReport()` å’Œ `GenerateMarkedForDeletionJsonReport()`

## ğŸ“‹ é‡æ§‹è¨ˆç•«

### éšæ®µ 1: æå–å…±ç”¨æ–¹æ³• âœ…

- [x] 1.1 æå–é è¦½åŠŸèƒ½
  ```csharp
  static List<int> ParsePreviewIndices(string previewPart, int maxCount)
  static bool HandlePreviewCommand(string? choice, List<string> files)
  ```

- [x] 1.2 æå–ç¢ºèªå°è©±æ¡†
  ```csharp
  static bool ConfirmAction(string message)
  ```

- [x] 1.3 çµ±ä¸€å ±è¡¨ç”Ÿæˆ
  ```csharp
  static void GenerateReport(
      Dictionary<string, List<(string path, string timestamp)>> groups,
      string reportPrefix,
      string templateFileName,
      string timestampLabel)
  ```

- [x] 1.4 æå– JSON åºåˆ—åŒ–é‚è¼¯
  ```csharp
  static string SerializeReportData(object reportData, bool indent = true)
  static object CreateReportData(
      Dictionary<string, List<(string path, string timestamp)>> groups,
      string timestampLabel)
  ```

### éšæ®µ 2: é‡æ§‹è³‡æ–™çµæ§‹

- [ ] 2.1 å»ºç«‹å…±ç”¨è³‡æ–™æ¨¡å‹
  ```csharp
  record FileGroup(string Hash, List<FileRecord> Files);
  record FileRecord(string Path, string Timestamp, bool Exists, long Size);
  ```

- [ ] 2.2 çµ±ä¸€è³‡æ–™è¼‰å…¥æ–¹æ³•
  ```csharp
  static Dictionary<string, List<(string, string)>> LoadFilesGroupedByHash(
      string tableName,
      string timestampColumn)
  ```

### éšæ®µ 3: ç°¡åŒ–æ“ä½œé¸å–®

- [ ] 3.1 æå–é¸å–®è™•ç†é‚è¼¯
  ```csharp
  static void HandleFileListMenu(
      List<(string path, string timestamp)> files,
      Action<List<string>> onUnmark,
      Action onClearAll)
  ```

- [ ] 3.2 çµ±ä¸€ç·¨è™Ÿè§£æ
  ```csharp
  static List<int> ParseIndices(string input, int maxCount)
  ```

### éšæ®µ 4: æ”¹å–„æ¶æ§‹

- [ ] 4.1 å¼•å…¥è³‡æ–™åº«æœå‹™å±¤
  ```csharp
  class DatabaseService { /* CRUD operations */ }
  ```

- [ ] 4.2 å¼•å…¥å ±è¡¨æœå‹™å±¤
  ```csharp
  class ReportService { /* Report generation */ }
  ```

- [ ] 4.3 å¼•å…¥æª”æ¡ˆé è¦½æœå‹™å±¤
  ```csharp
  class FilePreviewService { /* Preview logic */ }
  ```

- [ ] 4.4 åˆ†é›¢ UI é‚è¼¯
  ```csharp
  class ConsoleUI
  {
      static void ShowMenu(string[] options);
      static string GetUserInput(string prompt);
      static bool Confirm(string message);
  }
  ```

## ğŸ“Š é æœŸæ•ˆæœ

- **ç¨‹å¼ç¢¼è¡Œæ•¸**: å¾ 1990 è¡Œæ¸›å°‘åˆ°ç´„ 1400-1500 è¡Œ (æ¸›å°‘ 25-30%)
- **æ–¹æ³•æ•¸é‡**: å¾ 40+ å€‹æ–¹æ³•æ•´åˆåˆ°ç´„ 30 å€‹
- **å¯ç¶­è­·æ€§**: ä¿®æ”¹å ±è¡¨æ ¼å¼æˆ–é è¦½é‚è¼¯åªéœ€æ”¹ä¸€è™•
- **å¯æ¸¬è©¦æ€§**: æå–çš„å°æ–¹æ³•æ›´å®¹æ˜“é€²è¡Œå–®å…ƒæ¸¬è©¦

## ğŸ¯ å„ªå…ˆé †åºå»ºè­°

1. **é«˜å„ªå…ˆ**: éšæ®µ 1 (æå–å…±ç”¨æ–¹æ³•) - ç«‹å³è¦‹æ•ˆ
2. **ä¸­å„ªå…ˆ**: éšæ®µ 2 (é‡æ§‹è³‡æ–™çµæ§‹) - é•·æœŸç¶­è­·
3. **ä½å„ªå…ˆ**: éšæ®µ 3-4 (æ¶æ§‹æ”¹å–„) - å¯é¸æ“‡æ€§åŸ·è¡Œ

## ğŸ“ åŸ·è¡Œè¨˜éŒ„

- [x] éšæ®µ 1 å®Œæˆ (2025-10-06)
  - ç¨‹å¼ç¢¼è¡Œæ•¸ï¼šå¾ 1990 è¡Œæ¸›å°‘åˆ° 1844 è¡Œï¼ˆæ¸›å°‘ 146 è¡Œï¼Œç´„ 7.3%ï¼‰
  - ç·¨è­¯çµæœï¼šæˆåŠŸï¼Œ0 è­¦å‘Š 0 éŒ¯èª¤
  - ä¸»è¦æ”¹å–„ï¼š
    - æå–äº† 4 å€‹å…±ç”¨æ–¹æ³•ï¼ˆHandlePreviewCommandã€ConfirmActionã€ParseIndicesã€ParsePreviewIndicesï¼‰
    - çµ±ä¸€äº†å ±è¡¨ç”Ÿæˆé‚è¼¯ï¼ˆCreateReportDataã€SerializeReportDataã€GenerateReportï¼‰
    - åˆªé™¤äº† 4 å€‹é‡è¤‡çš„å ±è¡¨ç”Ÿæˆæ–¹æ³•
    - æ‰€æœ‰é è¦½åŠŸèƒ½å’Œç¢ºèªå°è©±æ¡†éƒ½å·²é‡æ§‹ä½¿ç”¨å…±ç”¨æ–¹æ³•
- [ ] éšæ®µ 2 å®Œæˆ
- [ ] éšæ®µ 3 å®Œæˆ
- [ ] éšæ®µ 4 å®Œæˆ
